#  Application Load Balancer (ALB) 구성 가이드

ALB는 OSI 모델의 **애플리케이션 계층(Layer 7)**에서 작동하며, HTTP/HTTPS 트래픽의 상세한 속성(URL 경로, 호스트 헤더 등)을 기반으로 라우팅 결정을 내립니다.

## 1. ALB 작동 프로세스

1. **요청 수신:** 클라이언트가 애플리케이션에 요청을 보내면 로드 밸런서 리스너가 이를 수신합니다.
2. **규칙 평가:** 리스너는 설정된 **우선순위**에 따라 리스너 규칙을 평가하여 적용할 규칙을 결정합니다.
3. **라우팅:** 규칙에 따라 적절한 **대상 그룹(Target Group)**으로 요청을 전달합니다. HTTPS 리스너를 사용할 경우 TLS 암호화/복복화 오프로드 작업이 수행됩니다.
4. **부하 분산:** 대상 그룹 내 정상 상태의 대상들이 로드 밸런싱 알고리즘에 따라 트래픽을 수신합니다.

---

## 2. 기본 구성 및 네트워크 매핑

### 2.1 로드 밸런서 기본 정보

* **이름:** 최대 32자의 영숫자와 하이픈(-)을 사용할 수 있습니다. 단, 하이픈으로 시작하거나 끝날 수 없습니다.
* **체계 (Scheme):**
* **인터넷 경계 (Internet-facing):** 퍼블릭 IP를 가지며 외부 인터넷 트래픽을 처리합니다. 퍼블릭 서브넷이 필요합니다.
* **내부 (Internal):** 프라이빗 IP를 가지며 내부 트래픽만 처리합니다.


* **IP 주소 유형:** IPv4 전용 또는 IPv4와 IPv6를 모두 지원하는 **듀얼 스택(Dualstack)** 중 선택할 수 있습니다.

### 2.2 네트워크 매핑

* **VPC:** 로드 밸런서가 존재하고 확장될 네트워크 환경을 선택합니다.
* **가용 영역 및 서브넷:** 고가용성을 위해 **2개 이상의 가용 영역(AZ)**을 선택해야 합니다. 로드 밸런서 노드는 선택한 각 영역에 배치되어 트래픽에 따라 자동 확장됩니다.

---

## 3. 리스너 및 라우팅 설정

리스너는 포트 및 프로토콜을 사용하여 연결 요청을 검사하는 프로세스입니다.

### 리스너 규칙 및 작업

* **프로토콜/포트:** 기본적으로 HTTP(80) 또는 HTTPS(443)를 사용합니다.
* **기본 작업 (Default Actions):** 일치하는 규칙이 없을 때 수행할 동작입니다.
* **대상 그룹으로 전달:** 특정 대상 그룹으로 트래픽 라우팅 (가중치 설정 가능).
* **리디렉션:** 다른 URL로 요청을 보냄.
* **고정 응답:** 커스텀 메시지와 함께 직접 응답 반환.


* **대상 그룹 고정성 (Stickiness):** 클라이언트의 세션을 특정 대상 그룹에 유지하도록 바인딩합니다 (쿠키 지원 필요).

---

## 4. 보안 및 성능 최적화 옵션

| 서비스 | 주요 혜택 | 고려 사항 |
| --- | --- | --- |
| **AWS WAF** | 일반적인 웹 취약점 및 봇 공격으로부터 애플리케이션 보호. | 내부 로드 밸런서에도 적용하여 내부 위협 방지 가능. |
| **Global Accelerator** | 2개의 글로벌 고정 IP를 제공하여 네트워크 성능 및 가용성 향상. | CloudFront와 호환되지 않으므로 서비스 목적에 따라 선택 필요. |

