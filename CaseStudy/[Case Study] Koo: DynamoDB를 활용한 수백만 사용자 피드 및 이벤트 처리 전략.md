# [Case Study] Koo: DynamoDB를 활용한 수백만 사용자 피드 및 이벤트 처리 전략

## 1. 배경 및 도전 과제

Koo는 사용자 수가 수십만 명에서 수백만 명으로 단기간에 폭증하면서 기존 시스템에서 심각한 병목 현상을 겪었습니다.

* **급격한 성장과 쓰기 병목:** 기존 PostgreSQL 시스템의 CPU 사용량이 100%에 도달하며 초당 수만 건의 쓰기 작업을 처리하지 못하는 상황이 발생했습니다.
* **성능 한계:** 관계형 DB의 수직적 확장(Vertical Scaling)만으로는 한계가 있었으며, 복잡한 인덱싱과 잠금(Locking) 문제가 성능 저하를 유발했습니다.
* **요구 사항:** 트래픽 변화에 유연하게 대응하며, 밀리초(ms) 단위의 지연 시간으로 대규모 데이터를 처리할 수 있는 데이터베이스가 필요했습니다.

---

## 2. Amazon DynamoDB 기반 핵심 아키텍처

Koo는 서비스의 핵심 기능인 피드(Feed), 좋아요(Likes), 팔로우(Follows) 기능을 DynamoDB로 이전하여 성능 문제를 해결했습니다.

### 2.1 NoSQL 데이터 모델링 (Single Table Design)

* **전략:** 여러 테이블을 조인(Join)하는 대신, 하나의 테이블에 연관된 데이터를 모아 관리하는 **싱글 테이블 디자인**을 적용했습니다.
* **효과:** 파티션 키(PK)와 정렬 키(SK) 설계를 통해 복잡한 쿼리 없이 필요한 데이터를 단일 요청으로 가져올 수 있어 성능을 극대화했습니다.

### 2.2 확장성 및 관리 효율성

* **온디맨드 및 예약 용량:** 초기에는 예측 불가능한 트래픽에 대응하기 위해 **온디맨드 모드**를 사용하고, 트래픽이 안정화된 이후에는 **예약 용량(Provisioned Capacity)**으로 전환하여 비용을 최적화했습니다.
* **완전 관리형 서비스:** 백업, 복제, 패치 등의 운영 업무를 AWS에 위임하여 개발팀은 서비스 로직 개선에 집중했습니다.

### 2.3 성능 최적화 (DAX 활용)

* **Amazon DynamoDB Accelerator (DAX):** 읽기 요청이 집중되는 데이터에 대해 인메모리 캐시인 DAX를 도입하여, 응답 시간을 **마이크로초(μs)** 단위로 단축했습니다.

---

## 3. 기술적 시너지: 이벤트 기반 데이터 파이프라인

Koo는 실시간 분석과 검색 기능을 강화하기 위해 다음과 같은 이벤트 기반 아키텍처를 구축했습니다.

1. **DynamoDB Streams:** 데이터의 생성, 수정, 삭제 이벤트를 실시간으로 캡처합니다.
2. **AWS Lambda:** 스트림 이벤트를 트리거로 삼아 **Amazon OpenSearch Service**로 데이터를 전달하여 실시간 검색 인덱스를 갱신하거나, 사용자 알림 서비스를 실행합니다.

---

## 4. 주요 성과

* **무한 확장성:** 수백만 명의 동시 접속자에게 중단 없는 안정적인 서비스 제공.
* **일관된 성능:** 트래픽 피크 타임에도 **10ms 이하**의 일관된 지연 시간 유지.
* **개발 민첩성:** 인프라 관리 부담 해소로 신규 기능 출시 속도(Time-to-Market) 향상.

---

## 💡 요약 및 인사이트

Koo의 사례는 대규모 트래픽 처리를 위해 **RDB에서 NoSQL로의 전환**이 선택이 아닌 필수임을 보여줍니다. 특히 **DynamoDB Streams + Lambda** 조합은 데이터 변경 사항을 검색 엔진이나 외부 알림 서비스로 전파하는 현대적인 **이벤트 기반 아키텍처(Event-driven Architecture)**의 표준적인 모범 사례입니다.

---

### 관련 섹션 연결

* [Architecture: Serverless & NoSQL Design](https://www.google.com/search?q=../architecture/README.md)
* [Case Study: High Traffic Social Platforms](https://www.google.com/search?q=../case-study/README.md)